{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49462102-62c5bd388bb9085ad52d727ed';\n\nexport async function findPhotos(query, page) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page,\n  });\n\n  return await axios(`https://pixabay.com/api/?${params}`);\n}","const gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\n\nexport const createGalleryCardTemplate = photoInfo => {\n  return photoInfo\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-img\"\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n          loading=\"lazy\"\n        />\n      </a>\n      <ul class=\"gallery-info\">\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Likes</p>\n          <p class=\"gallery-info-text\">${likes}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Views</p>\n          <p class=\"gallery-info-text\">${views}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Comments</p>\n          <p class=\"gallery-info-text\">${comments}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Downloads</p>\n          <p class=\"gallery-info-text\">${downloads}</p>\n        </li>\n      </ul>\n    </li>`\n    )\n    .join('');\n};\n\nexport const clearGallery = () => {\n  gallery.innerHTML = '';\n};\n\nexport const showLoader = () => {\n  loader.classList.remove('is-hidden');\n};\n\nexport const hideLoader = () => {\n  loader.classList.add('is-hidden');\n};\n\nexport const showLoadMoreBtn = () => {\n  loadMoreBtnEl.classList.remove('is-hidden');\n};\n\nexport const hideLoadMoreBtn = () => {\n  loadMoreBtnEl.classList.add('is-hidden');\n};\n","import iziToast from \"izitoast\";\nimport { findPhotos } from \"./js/pixabay-api\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport {\n  createGalleryCardTemplate,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreBtn,\n  hideLoadMoreBtn,\n} from \"./js/render-functions\";\n\nconst searchFormEl = document.querySelector('.form-search');\nconst galleryEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\n\nlet currentPage = 1;\nlet searchedValue = '';\nlet quantityElements = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  captionsData: 'alt',\n  overlayOpacity: 1,\n});\n\nconst searchFormSubmit = async event => {\n  event.preventDefault();\n\n  searchedValue = searchFormEl.elements[\"search-text\"].value.trim();\n\n  if (searchedValue === '') {\n    iziToast.warning({\n      message: 'Please enter a search query.',\n      position: 'bottomRight',\n    });\n    return;\n  }\n\n  clearGallery();\n  quantityElements = 0;\n  hideLoadMoreBtn();\n  showLoader();\n  currentPage = 1;\n\n  try {\n    const response = await findPhotos(searchedValue, currentPage);\n    const data = response.data;\n\n    if (!data || !data.hits || data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'bottomRight',\n      });\n      searchFormEl.reset();\n      return;\n    }\n\n    const markup = createGalleryCardTemplate(data.hits);\n    galleryEl.innerHTML = markup;\n    lightbox.refresh();\n\n    showLoadMoreBtn();\n    searchFormEl.reset();\n    quantityElements += data.hits.length;\n\n  } catch (err) {\n    console.log(err);\n    iziToast.error({\n      message: 'An error occurred. Please try again later.',\n      position: 'bottomRight',\n    });\n  } finally {\n    hideLoader();\n  }\n};\n\nconst onLoadMorePhoto = async () => {\n  try {\n    showLoader();\n    currentPage++;\n    const response = await findPhotos(searchedValue, currentPage);\n    const data = response.data;\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      hideLoadMoreBtn();\n      return;\n    }\n\n    const markup = createGalleryCardTemplate(data.hits);\n    galleryEl.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n\n    const firstCard = galleryEl.firstElementChild;\n    const { height: cardHeight } = firstCard.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    quantityElements += data.hits.length;\n\n    if (Math.ceil(data.totalHits / 15) === currentPage) {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      hideLoadMoreBtn();\n    }\n\n  } catch (err) {\n    console.log(err);\n  } finally {\n    hideLoader();\n  }\n};\n\nsearchFormEl.addEventListener('submit', searchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMorePhoto);\n"],"names":["API_KEY","findPhotos","query","page","params","axios","gallery","loader","loadMoreBtnEl","createGalleryCardTemplate","photoInfo","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","searchFormEl","galleryEl","currentPage","searchedValue","quantityElements","lightbox","SimpleLightbox","searchFormSubmit","event","iziToast","data","markup","err","onLoadMorePhoto","firstCard","cardHeight"],"mappings":"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"}