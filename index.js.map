{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49462102-62c5bd388bb9085ad52d727ed';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport default async function getImagesByQuery(query, page) {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\n\nexport const createGalleryCardTemplate = photoInfo => {\n  const markup = photoInfo\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-img\"\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n          loading=\"lazy\"\n        />\n      </a>\n      <ul class=\"gallery-info\">\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Likes</p>\n          <p class=\"gallery-info-text\">${likes}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Views</p>\n          <p class=\"gallery-info-text\">${views}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Comments</p>\n          <p class=\"gallery-info-text\">${comments}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n          <p class=\"gallery-info-title\">Downloads</p>\n          <p class=\"gallery-info-text\">${downloads}</p>\n        </li>\n      </ul>\n    </li>`\n    )\n    .join('');\n  \n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n  \n};\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  captionsData: 'alt',\n  overlayOpacity: 1,\n});\n\nexport function  clearGallery() {\n  gallery.innerHTML = '';\n};\n\nexport function  showLoader() {\n  loader.classList.remove('is-hidden');\n};\n\nexport function  hideLoader() {\n  loader.classList.add('is-hidden');\n};\n\nexport function  showLoadMoreBtn() {\n  loadMoreBtnEl.classList.remove('is-hidden');\n};\n\nexport function  hideLoadMoreBtn() {\n  loadMoreBtnEl.classList.add('is-hidden');\n};\n","import iziToast from \"izitoast\";\nimport getImagesByQuery from \"./js/pixabay-api\";\n\nimport {\n  createGalleryCardTemplate,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreBtn,\n  hideLoadMoreBtn,\n} from \"./js/render-functions\";\n\nconst searchFormEl = document.querySelector('.form-search');\nconst galleryEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\n\nlet currentPage = 1;\nlet searchedValue = '';\nlet quantityElements = 0;\nlet totalHits = 0;\n\nconst searchFormSubmit = async event => {\n  event.preventDefault();\n\n  searchedValue = searchFormEl.elements[\"search-text\"].value.trim();\n\n  if (searchedValue === '') {\n    iziToast.warning({\n      message: 'Please enter a search query.',\n      position: 'bottomRight',\n    });\n    return;\n  }\n\n  quantityElements = 0;\n  currentPage = 1;\n  clearGallery();\n  hideLoadMoreBtn();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(searchedValue, currentPage);\n    \n\n    if (!data || !data.hits || data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'bottomRight',\n      });\n      searchFormEl.reset();\n      return;\n    }\n\n    totalHits = data.totalHits;\n    createGalleryCardTemplate(data.hits);\n\n    quantityElements += data.hits.length;\n\n    if (quantityElements < totalHits) {\n      showLoadMoreBtn();\n    } else {\n      hideLoadMoreBtn();\n    }\n\n    searchFormEl.reset();\n\n  } catch (err) {\n    console.log(err);\n    iziToast.error({\n      message: 'An error occurred. Please try again later.',\n      position: 'bottomRight',\n    });\n  } finally {\n    hideLoader();\n  }\n};\n\nconst onLoadMorePhoto = async () => {\n  try {\n    showLoader();\n    currentPage++;\n\n    const data = await getImagesByQuery(searchedValue, currentPage);\n\n    if (!data || !data.hits || data.hits.length === 0) {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      hideLoadMoreBtn();\n      return;\n    }\n\n    createGalleryCardTemplate(data.hits);\n\n    const firstCard = galleryEl.firstElementChild;\n    const { height: cardHeight } = firstCard.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    quantityElements += data.hits.length;\n\n    if (quantityElements >= totalHits) {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      hideLoadMoreBtn();\n    }\n\n  } catch (err) {\n    console.log(err);\n  } finally {\n    hideLoader();\n  }\n};\n\nsearchFormEl.addEventListener('submit', searchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMorePhoto);\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","axios","gallery","loader","loadMoreBtnEl","createGalleryCardTemplate","photoInfo","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","searchFormEl","galleryEl","currentPage","searchedValue","quantityElements","totalHits","searchFormSubmit","event","iziToast","data","err","onLoadMorePhoto","firstCard","cardHeight"],"mappings":"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"}